# 自动化测试用例版本管理 - 用户使用指南

## 功能概述

自动化测试用例版本管理功能允许您一键保存ROLE1-4的所有测试用例，并支持版本历史查看、下载和管理。

## 核心功能

### 1. 版本保存
- **一键保存**：自动导出ROLE1-4的所有用例为Excel文件
- **格式**：19列全语言（中文/日文/英文）
- **打包**：4个Excel文件自动打包成zip
- **版本ID**：格式为`项目名_YYYYMMDD_HHMMSS`

### 2. 版本管理
- **历史查看**：查看所有历史版本列表
- **文件信息**：显示每个版本包含的4个文件及用例数量
- **备注管理**：为每个版本添加说明（最多200字）
- **版本下载**：下载zip压缩包到本地
- **版本删除**：删除不需要的历史版本

---

## 使用步骤

### 步骤1：保存版本

1. **进入项目**
   - 登录系统
   - 点击左侧菜单"项目管理"
   - 选择要操作的项目

2. **切换到自动化测试用例Tab**
   - 点击顶部"自动化测试用例"Tab
   - 默认显示ROLE1 Tab

3. **点击保存版本**
   - 在ROLE1 Tab顶部找到"保存版本"按钮（💾图标）
   - 点击按钮开始保存

4. **等待保存完成**
   - 系统会显示loading状态
   - 保存成功后弹出提示："版本保存成功"
   - 自动跳转到"版本管理"Tab

**注意事项**：
- ⚠️ 保存版本会同时导出ROLE1-4的所有用例
- ⚠️ 即使某个ROLE没有用例，也会生成空Excel文件
- ⏱️ 保存时间取决于用例数量（1000条约3-5秒）

---

### 步骤2：查看版本列表

1. **切换到版本管理Tab**
   - 点击顶部"版本管理"Tab
   - 或在保存版本后自动跳转

2. **查看版本信息**
   
   版本列表包含4列信息：
   
   | 列名 | 说明 | 示例 |
   |------|------|------|
   | 版本ID | 版本唯一标识 | `WebTest_20250121_143052` |
   | 版本文件名 | 4个Excel文件列表 | role1.xlsx (35条用例, 12.5KB) |
   | 备注 | 版本说明 | "v1.0 基线版本" |
   | 操作 | 下载/删除按钮 | 🔽下载 ❌删除 |

3. **分页浏览**
   - 每页显示10条记录
   - 底部分页器可切换页码
   - 版本按创建时间倒序排列（最新在最前）

---

### 步骤3：下载版本

1. **选择要下载的版本**
   - 在版本列表中找到目标版本

2. **点击下载按钮**
   - 点击"下载"按钮（蓝色，带下载图标）
   - 系统显示"正在准备下载..."

3. **保存文件**
   - 浏览器弹出下载对话框
   - 文件名格式：`版本ID.zip`
   - 选择保存位置并确认

4. **解压查看**
   - 解压zip文件
   - 包含4个Excel文件：
     - `项目名_Autotestcase_ROLE1_时间戳.xlsx`
     - `项目名_Autotestcase_ROLE2_时间戳.xlsx`
     - `项目名_Autotestcase_ROLE3_时间戳.xlsx`
     - `项目名_Autotestcase_ROLE4_时间戳.xlsx`

**Excel文件格式（19列）**：
1. ID
2. 用例编号
3-7. 画面/功能/前置条件/测试步骤/期待值（中文）
8-12. 画面/功能/前置条件/测试步骤/期待值（日文）
13-17. 画面/功能/前置条件/测试步骤/期待值（英文）
18. 测试结果
19. 备注

---

### 步骤4：编辑版本备注

1. **点击备注区域**
   - 点击版本列表中的"备注"列
   - 空白备注显示"点击添加备注..."

2. **输入备注内容**
   - 输入框出现，输入备注文字
   - 最多200个字符
   - 右侧显示"保存"和"取消"按钮

3. **保存或取消**
   - **保存**：点击"保存"按钮或按Enter键
   - **取消**：点击"取消"按钮或点击其他位置
   - 保存成功后显示提示："备注更新成功"

**备注示例**：
- ✅ "v1.0 基线版本"
- ✅ "修复登录问题后的版本"
- ✅ "2025-01-21 提交测试"
- ❌ "超过200字符的备注会被截断超过200字符的备注会被截断..." （太长）

---

### 步骤5：删除版本

1. **选择要删除的版本**
   - 在版本列表中找到不需要的版本

2. **点击删除按钮**
   - 点击"删除"按钮（红色，带删除图标）
   - 弹出确认对话框

3. **确认删除**
   - **确认对话框内容**：
     - 标题："确定删除此版本吗？"
     - 描述："删除后无法恢复"
     - 按钮："确定" / "取消"
   
4. **等待删除完成**
   - 点击"确定"开始删除
   - 删除成功后显示提示："删除成功"
   - 版本从列表中移除

**注意事项**：
- ⚠️ 删除操作会同时删除：
  - 数据库中的4条版本记录
  - 服务器上的4个Excel物理文件
- ⚠️ 删除后无法恢复，请谨慎操作
- ⚠️ 建议定期备份重要版本到本地

---

## 使用场景

### 场景1：项目里程碑备份
**时机**：每次项目重要里程碑节点  
**操作**：
1. 保存版本
2. 添加备注："v1.0 提交UAT"
3. 下载到本地备份

### 场景2：测试前快照
**时机**：每次提交测试前  
**操作**：
1. 保存版本
2. 添加备注："2025-01-21 提交测试"
3. 留作测试基准

### 场景3：定期归档
**时机**：每周五下午  
**操作**：
1. 保存版本
2. 添加备注："Week 03 归档"
3. 清理180天前的旧版本

### 场景4：版本对比
**时机**：需要对比不同时间点的用例  
**操作**：
1. 下载旧版本zip
2. 保存当前版本
3. 使用Excel对比工具比较差异

---

## 最佳实践

### 1. 版本管理策略
- ✅ **定期保存**：建议每周至少保存一次
- ✅ **重要节点**：项目里程碑必须保存
- ✅ **添加备注**：每个版本都应添加清晰的备注
- ✅ **及时下载**：重要版本下载到本地备份

### 2. 备注命名规范
推荐格式：
- `v{版本号} {说明}` - 例："v1.0 基线版本"
- `{日期} {事件}` - 例："2025-01-21 提交测试"
- `Week {周数} {说明}` - 例："Week 03 归档"

### 3. 存储管理
- ✅ 定期清理180天前的旧版本
- ✅ 重要版本备份到多个位置
- ✅ 监控服务器存储空间

### 4. 性能优化
- ✅ 避免频繁保存（间隔至少10分钟）
- ✅ 用例数超过5000时，保存时间可能较长
- ✅ 网络较慢时下载大文件请耐心等待

---

## 常见问题

### Q1: 保存版本时显示"没有可导出的用例"
**A**: 检查项目中是否存在自动化测试用例，至少需要一个ROLE有用例。

### Q2: 下载的zip文件无法解压
**A**: 可能是下载不完整，请重新下载。检查文件大小是否正常。

### Q3: 备注保存后没有更新
**A**: 刷新页面重新查看，如果仍未更新请检查网络连接。

### Q4: 删除版本后还能恢复吗？
**A**: 不能。删除操作会永久删除文件和记录，请谨慎操作。

### Q5: Excel文件中的数据不全
**A**: 可能是保存时数据库查询出错，请重新保存版本。

### Q6: 为什么我看不到"保存版本"按钮？
**A**: 只有PM和PM Member角色才能保存版本，请检查您的权限。

### Q7: 保存版本需要多长时间？
**A**: 
- 100条用例：约1-2秒
- 500条用例：约2-3秒
- 1000条用例：约3-5秒
- 5000条用例：约10-15秒

### Q8: 版本ID是如何生成的？
**A**: 格式为`{项目名}_{YYYYMMDD_HHMMSS}`，基于保存时的时间戳，确保唯一性。

### Q9: 可以批量删除多个版本吗？
**A**: 当前版本不支持批量删除，需要逐个删除。

### Q10: Excel文件可以编辑后重新上传吗？
**A**: 当前版本不支持上传功能，版本管理仅用于备份和下载。

---

## 快捷键（未来规划）

当前版本暂不支持快捷键，未来可能支持：
- `Ctrl+S` - 快速保存版本
- `Ctrl+D` - 下载选中版本
- `Del` - 删除选中版本

---

## 技术支持

如遇到问题，请联系：
- **技术支持邮箱**: support@example.com
- **问题反馈**: https://github.com/yourorg/webtest/issues
- **用户手册**: https://docs.example.com/webtest

---

**文档版本**: v1.0  
**更新日期**: 2025-01-21  
**适用版本**: Web智能测试平台 v2.0+
