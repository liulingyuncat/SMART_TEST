# 多语言编辑功能使用指南

## 快速开始

### 访问功能
1. 启动后端服务器: `cd backend && go run cmd/server/main.go`
2. 启动前端服务器: `cd frontend && npm start`
3. 访问 http://localhost:3000
4. 登录系统
5. 进入任意项目的详情页
6. 点击"手工用例"tab

## 使用场景

### 场景1: 编辑整体用例 (中文模式)

#### 步骤:
1. 在"手工用例"页面，点击**整体用例**tab
2. 语言选择器选择**中文**
3. 找到需要编辑的用例
4. **直接点击**任意可编辑字段的内容 (例如: Maj.CategoryCN)
5. 弹出多语言编辑对话框
6. 同时编辑三种语言的内容:
   - 中文 (CN)
   - 日文 (JP)  
   - 英文 (EN)
7. 点击**保存**按钮
8. 系统自动更新所有三种语言的字段

#### 可编辑字段:
- Maj.CategoryCN (大功能分类)
- Mid.CategoryCN (中功能分类)
- Min.CategoryCN (小功能分类)
- PreconditionCN (前置条件) - 多行文本
- Test StepCN (测试步骤) - 多行文本
- ExpectCN (期待值) - 多行文本

#### 注意事项:
- ✅ 点击字段内容即可编辑
- ✅ 操作列只显示"删除"按钮
- ✅ CaseID和Remark仍然可以直接点击编辑
- ⚠️ 编辑其他用例时，需要先保存当前编辑

### 场景2: 编辑整体用例 (日文模式)

#### 步骤:
1. 在"手工用例"页面，点击**整体用例**tab
2. 语言选择器选择**日本語**
3. 找到需要编辑的用例
4. 点击操作列的**编辑**按钮
5. 该行进入编辑状态
6. 编辑日文字段内容
7. 点击**保存**按钮
8. 只更新日文字段，其他语言不变

#### 显示字段:
- Maj.CategoryJP
- Mid.CategoryJP
- Min.CategoryJP
- PreconditionJP
- Test StepJP
- ExpectJP

#### 注意事项:
- ✅ 操作列显示"编辑"和"删除"两个按钮
- ✅ 只修改日文字段
- ✅ 中文和英文字段保持不变

### 场景3: 编辑整体用例 (英文模式)

与日文模式相同，只是字段后缀变为EN:
- Maj.CategoryEN
- Mid.CategoryEN
- Min.CategoryEN
- PreconditionEN
- Test StepEN
- ExpectEN

### 场景4: 编辑变更用例

变更用例的所有功能与整体用例**完全相同**:
- 中文模式: 点击字段弹出多语言对话框
- 日文/英文模式: 点击编辑按钮进行行内编辑
- ID编号独立管理

### 场景5: 编辑AI用例

AI用例**不支持**多语言编辑:
- 始终使用行内编辑
- 点击"编辑"按钮进入编辑状态
- 操作列显示"编辑"和"删除"按钮
- 字段名称: Maj.Category, Mid.Category等 (无语言后缀)

## 对话框功能说明

### 对话框界面
```
┌─────────────────────────────────────┐
│ 编辑大功能分类 (Major Function)      ×│
├─────────────────────────────────────┤
│ 中文 (CN)                            │
│ [________________输入框______________] │
│                                      │
│ 日文 (JP)                            │
│ [________________输入框______________] │
│                                      │
│ 英文 (EN)                            │
│ [________________输入框______________] │
│                                      │
│           [取消]  [保存]              │
└─────────────────────────────────────┘
```

### 输入组件类型

#### 单行文本 (Input)
用于短文本字段，最大100字符:
- 大功能 (major_function)
- 中功能 (middle_function)
- 小功能 (minor_function)

#### 多行文本 (TextArea)
用于长文本字段，最大2000字符:
- 前置条件 (precondition)
- 测试步骤 (test_steps)
- 期待值 (expected_result)

### 表单验证
- 输入超过字符限制时显示错误提示
- 必须修正错误才能保存
- 空值也可以保存

## 常见问题

### Q1: 为什么点击字段没有弹出对话框?
**可能原因**:
1. 当前语言不是中文模式
2. 当前正在编辑其他行
3. 当前Tab不是整体用例或变更用例
4. 点击的是AI用例

**解决方法**:
- 确保语言选择器选择"中文"
- 确保没有其他行在编辑状态
- 切换到整体用例或变更用例Tab

### Q2: 日文模式下为什么没有多语言对话框?
这是**正常行为**。按照需求设计:
- 中文模式: 使用多语言对话框
- 日文模式: 使用行内编辑
- 英文模式: 使用行内编辑

### Q3: 如何同时编辑多个用例?
**不支持**。系统设计为一次只能编辑一个用例，防止数据冲突。

### Q4: 保存后数据没有更新?
**检查步骤**:
1. 查看浏览器控制台是否有错误
2. 确认后端服务器正在运行
3. 检查网络请求是否成功
4. 刷新页面重新加载数据

### Q5: 超过字符限制怎么办?
**解决方法**:
- 短文本字段: 压缩内容到100字符以内
- 长文本字段: 压缩内容到2000字符以内
- 如需更长内容，请联系管理员调整限制

## 键盘快捷键

目前不支持快捷键，后续版本可能添加:
- `Ctrl+S`: 保存 (计划中)
- `ESC`: 取消 (计划中)

## 数据同步说明

### 中文模式保存
保存时同时更新三个字段:
```javascript
// 用户编辑大功能分类
CN: "用户管理"
JP: "ユーザー管理"
EN: "User Management"

// 数据库更新
UPDATE manual_test_cases SET
  major_function_cn = "用户管理",
  major_function_jp = "ユーザー管理",
  major_function_en = "User Management"
WHERE id = 123;
```

### 日文/英文模式保存
只更新当前语言字段:
```javascript
// 日文模式编辑
JP: "ユーザー管理システム"

// 数据库更新 (只更新JP字段)
UPDATE manual_test_cases SET
  major_function_jp = "ユーザー管理システム"
WHERE id = 123;

// CN和EN字段保持不变
```

## 最佳实践

### 1. 中文优先录入
建议先在中文模式下录入所有三种语言的数据，这样可以:
- ✅ 一次性完成三种语言的录入
- ✅ 避免在不同语言模式间切换
- ✅ 确保三种语言的数据一致性

### 2. 语言切换预览
录入完成后，切换语言查看效果:
- 切换到日文模式查看日文显示
- 切换到英文模式查看英文显示
- 确保所有语言都正确显示

### 3. 批量操作
如需批量录入:
1. 准备好三种语言的内容
2. 在中文模式下逐条录入
3. 使用多语言对话框同时输入三种语言

### 4. 内容验证
保存前检查:
- 字符数是否在限制内
- 内容是否完整
- 翻译是否准确

## 技术支持

如遇到问题，请提供以下信息:
1. 操作步骤
2. 当前Tab (AI用例/整体用例/变更用例)
3. 当前语言选择
4. 浏览器控制台错误信息
5. 截图 (如果可能)

联系方式: [待补充]
